# Makefile for AIClient-2-API Rust version

.PHONY: help build test run clean docker fmt check clippy dev release install

help:
	@echo "AIClient-2-API Rust - Available commands:"
	@echo ""
	@echo "  make build      - Build the project in debug mode"
	@echo "  make release    - Build optimized release version"
	@echo "  make test       - Run all tests"
	@echo "  make run        - Run the server in debug mode"
	@echo "  make dev        - Run with auto-reload (requires cargo-watch)"
	@echo "  make clean      - Clean build artifacts"
	@echo "  make fmt        - Format code with rustfmt"
	@echo "  make check      - Quick compile check"
	@echo "  make clippy     - Run clippy linter"
	@echo "  make docker     - Build Docker image"
	@echo "  make install    - Install the binary to ~/.cargo/bin"
	@echo "  make help       - Show this help message"

build:
	@echo "ğŸ”¨ Building project..."
	cargo build

release:
	@echo "ğŸš€ Building release version..."
	cargo build --release
	@echo "âœ… Binary: ./target/release/aiclient2api-rust"

test:
	@echo "ğŸ§ª Running tests..."
	cargo test -- --nocapture

run:
	@echo "â–¶ï¸  Running server..."
	RUST_LOG=info cargo run

dev:
	@echo "ğŸ”§ Starting development mode..."
	@./scripts/dev.sh

clean:
	@echo "ğŸ§¹ Cleaning build artifacts..."
	cargo clean

fmt:
	@echo "âœ¨ Formatting code..."
	cargo fmt

check:
	@echo "ğŸ” Checking code..."
	cargo check

clippy:
	@echo "ğŸ“ Running clippy..."
	cargo clippy -- -D warnings

docker:
	@echo "ğŸ³ Building Docker image..."
	@./scripts/docker-build.sh

install:
	@echo "ğŸ“¦ Installing binary..."
	cargo install --path .

# Development workflow
dev-full: fmt clippy test build
	@echo "âœ… Development checks passed!"

# CI workflow
ci: fmt check clippy test
	@echo "âœ… CI checks passed!"

# Quick development iteration
quick: fmt check
	@echo "âœ… Quick checks passed!"

